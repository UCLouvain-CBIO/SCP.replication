<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>ComBat v3.34 batch correction — ComBatv3.34 • SCP.replication</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="ComBat v3.34 batch correction — ComBatv3.34"><meta property="og:description" content="Older version of ComBat (sva version 3.34.0). This is for
compatibility with the replication of SCoPE2.
ComBat allows users to adjust for batch effects in datasets where
the batch covariate is known, using methodology described in
Johnson et al. 2007. It uses either parametric or non-parametric
empirical Bayes frameworks for adjusting data for batch effects.
Users are returned an expression matrix that has been corrected
for batch effects. The input data are assumed to be cleaned and
normalized before batch effect removal."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SCP.replication</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/SCoPE2.html">Reproduction of the SCoPE2 analysis (Specht et al. 2021)</a>
    </li>
    <li>
      <a href="../articles/liang2020.html">Exploring the autoPOTS data (Liang et al. 2020)</a>
    </li>
    <li>
      <a href="../articles/schoof2021.html">Reproduction of the AML model analysis (Schoof et al. 2021)</a>
    </li>
    <li>
      <a href="../articles/williams2020_tmt.html">Reproducing the multiplexed SCP analysis by Williams et al. 2020)</a>
    </li>
    <li>
      <a href="../articles/zhu2019EL.html">Reproduction of the hair-cell development analysis (Zhu et al. 2019, eLife)</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>ComBat v3.34 batch correction</h1>
    
    <div class="hidden name"><code>ComBatv3.34.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Older version of ComBat (sva version 3.34.0). This is for
compatibility with the replication of SCoPE2.</p>
<p>ComBat allows users to adjust for batch effects in datasets where
the batch covariate is known, using methodology described in
Johnson et al. 2007. It uses either parametric or non-parametric
empirical Bayes frameworks for adjusting data for batch effects.
Users are returned an expression matrix that has been corrected
for batch effects. The input data are assumed to be cleaned and
normalized before batch effect removal.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">ComBatv3.34</span><span class="op">(</span>
  <span class="va">dat</span>,
  <span class="va">batch</span>,
  mod <span class="op">=</span> <span class="cn">NULL</span>,
  par.prior <span class="op">=</span> <span class="cn">TRUE</span>,
  prior.plots <span class="op">=</span> <span class="cn">FALSE</span>,
  mean.only <span class="op">=</span> <span class="cn">FALSE</span>,
  ref.batch <span class="op">=</span> <span class="cn">NULL</span>,
  BPPARAM <span class="op">=</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">bpparam</a></span><span class="op">(</span><span class="st">"SerialParam"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>dat</dt>
<dd><p>Genomic measure matrix (dimensions probe x sample) -
for example, expression matrix</p></dd>
<dt>batch</dt>
<dd><p>Batch covariate (only one batch allowed)</p></dd>
<dt>mod</dt>
<dd><p>Model matrix for outcome of interest and other
covariates besides batch</p></dd>
<dt>par.prior</dt>
<dd><p>(Optional) TRUE indicates parametric adjustments
will be used, FALSE indicates non-parametric adjustments will
be used</p></dd>
<dt>prior.plots</dt>
<dd><p>(Optional) TRUE give prior plots with black as
a kernel estimate of the empirical batch effect density and
red as the parametric</p></dd>
<dt>mean.only</dt>
<dd><p>(Optional) FALSE If TRUE ComBat only corrects the
mean of the batch effect (no scale adjustment)</p></dd>
<dt>ref.batch</dt>
<dd><p>(Optional) NULL If given, will use the selected
batch as a reference for batch adjustment.</p></dd>
<dt>BPPARAM</dt>
<dd><p>(Optional) BiocParallelParam for parallel operation</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>data A probe x sample genomic measure matrix, adjusted for batch effects.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">bladderbatch</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in library(bladderbatch):</span> there is no package called ‘bladderbatch’</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">bladderdata</span><span class="op">)</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>data set ‘bladderdata’ not found</span>
<span class="r-in"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">bladderEset</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span>,<span class="op">]</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'bladderEset' not found</span>
<span class="r-in"></span>
<span class="r-in"><span class="va">pheno</span> <span class="op">&lt;-</span> <span class="fu">pData</span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'object' in selecting a method for function 'pData': object 'dat' not found</span>
<span class="r-in"><span class="va">edata</span> <span class="op">&lt;-</span> <span class="fu">exprs</span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'object' in selecting a method for function 'exprs': object 'dat' not found</span>
<span class="r-in"><span class="va">batch</span> <span class="op">&lt;-</span> <span class="va">pheno</span><span class="op">$</span><span class="va">batch</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'pheno' not found</span>
<span class="r-in"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">cancer</span><span class="op">)</span>, data<span class="op">=</span><span class="va">pheno</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in terms.formula(object, data = data):</span> object 'pheno' not found</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># parametric adjustment</span></span>
<span class="r-in"><span class="va">combat_edata1</span> <span class="op">&lt;-</span> <span class="fu">ComBatv3.34</span><span class="op">(</span>dat<span class="op">=</span><span class="va">edata</span>, batch<span class="op">=</span><span class="va">batch</span>, mod<span class="op">=</span><span class="cn">NULL</span>, par.prior<span class="op">=</span><span class="cn">TRUE</span>, prior.plots<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in ComBatv3.34(dat = edata, batch = batch, mod = NULL, par.prior = TRUE,     prior.plots = FALSE):</span> object 'batch' not found</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># non-parametric adjustment, mean-only version</span></span>
<span class="r-in"><span class="va">combat_edata2</span> <span class="op">&lt;-</span> <span class="fu">ComBatv3.34</span><span class="op">(</span>dat<span class="op">=</span><span class="va">edata</span>, batch<span class="op">=</span><span class="va">batch</span>, mod<span class="op">=</span><span class="cn">NULL</span>, par.prior<span class="op">=</span><span class="cn">FALSE</span>, mean.only<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using the 'mean only' version of ComBat</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in ComBatv3.34(dat = edata, batch = batch, mod = NULL, par.prior = FALSE,     mean.only = TRUE):</span> object 'batch' not found</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># reference-batch version, with covariates</span></span>
<span class="r-in"><span class="va">combat_edata3</span> <span class="op">&lt;-</span> <span class="fu">ComBatv3.34</span><span class="op">(</span>dat<span class="op">=</span><span class="va">edata</span>, batch<span class="op">=</span><span class="va">batch</span>, mod<span class="op">=</span><span class="va">mod</span>, par.prior<span class="op">=</span><span class="cn">TRUE</span>, ref.batch<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in ComBatv3.34(dat = edata, batch = batch, mod = mod, par.prior = TRUE,     ref.batch = 3):</span> object 'batch' not found</span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Christophe Vanderaa, Laurent Gatto.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

